!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("dragula")):"function"==typeof define&&define.amd?define("ng2-dragula",["exports","@angular/core","rxjs","rxjs/operators","dragula"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["ng2-dragula"]={},e.ng.core,e.rxjs,e.rxjs.operators,e.dragula)}(this,(function(e,t,r,n,o){"use strict";function i(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var a=i(o);
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function s(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}var u,d=function(e,t,r){this.name=e,this.drake=t,this.options=r,this.initEvents=!1};e.EventTypes=void 0,(u=e.EventTypes||(e.EventTypes={})).Cancel="cancel",u.Cloned="cloned",u.Drag="drag",u.DragEnd="dragend",u.Drop="drop",u.Out="out",u.Over="over",u.Remove="remove",u.Shadow="shadow",u.DropModel="dropModel",u.RemoveModel="removeModel";var c=Object.keys(e.EventTypes).map((function(t){return e.EventTypes[t]})),l=a.default||a,p=function(e){void 0===e&&(e=l),this.build=e},f=function(e,t,r){return function(o){return o.pipe(n.filter((function(r){var n=r.event,o=r.name;return n===e&&(void 0===t||o===t)})),n.map((function(e){var t=e.name,n=e.args;return r(t,n)})))}},h=function(e,t){var r=s(t,3);return{name:e,el:r[0],container:r[1],source:r[2]}},v=function(){function t(t){var n=this;void 0===t&&(t=null),this.drakeFactory=t,this.dispatch$=new r.Subject,this.drag=function(t){return n.dispatch$.pipe(f(e.EventTypes.Drag,t,(function(e,t){var r=s(t,2);return{name:e,el:r[0],source:r[1]}})))},this.dragend=function(t){return n.dispatch$.pipe(f(e.EventTypes.DragEnd,t,(function(e,t){return{name:e,el:s(t,1)[0]}})))},this.drop=function(t){return n.dispatch$.pipe(f(e.EventTypes.Drop,t,(function(e,t){var r=s(t,4);return{name:e,el:r[0],target:r[1],source:r[2],sibling:r[3]}})))},this.elContainerSource=function(e){return function(t){return n.dispatch$.pipe(f(e,t,h))}},this.cancel=this.elContainerSource(e.EventTypes.Cancel),this.remove=this.elContainerSource(e.EventTypes.Remove),this.shadow=this.elContainerSource(e.EventTypes.Shadow),this.over=this.elContainerSource(e.EventTypes.Over),this.out=this.elContainerSource(e.EventTypes.Out),this.cloned=function(t){return n.dispatch$.pipe(f(e.EventTypes.Cloned,t,(function(e,t){var r=s(t,3);return{name:e,clone:r[0],original:r[1],cloneType:r[2]}})))},this.dropModel=function(t){return n.dispatch$.pipe(f(e.EventTypes.DropModel,t,(function(e,t){var r=s(t,9);return{name:e,el:r[0],target:r[1],source:r[2],sibling:r[3],item:r[4],sourceModel:r[5],targetModel:r[6],sourceIndex:r[7],targetIndex:r[8]}})))},this.removeModel=function(t){return n.dispatch$.pipe(f(e.EventTypes.RemoveModel,t,(function(e,t){var r=s(t,6);return{name:e,el:r[0],container:r[1],source:r[2],item:r[3],sourceModel:r[4],sourceIndex:r[5]}})))},this.groups={},null===this.drakeFactory&&(this.drakeFactory=new p)}return t.prototype.add=function(e){if(this.find(e.name))throw new Error('Group named: "'+e.name+'" already exists.');return this.groups[e.name]=e,this.handleModels(e),this.setupEvents(e),e},t.prototype.find=function(e){return this.groups[e]},t.prototype.destroy=function(e){var t=this.find(e);t&&(t.drake&&t.drake.destroy(),delete this.groups[e])},t.prototype.createGroup=function(e,t){return this.add(new d(e,this.drakeFactory.build([],t),t))},t.prototype.handleModels=function(t){var r,n,o,i=this,a=t.name,s=t.drake,u=t.options;s.on("remove",(function(t,r,o){if(s.models){var u=s.models[s.containers.indexOf(o)],d=(u=u.slice(0)).splice(n,1)[0];i.dispatch$.next({event:e.EventTypes.RemoveModel,name:a,args:[t,r,o,d,u,n]})}})),s.on("drag",(function(e,t){s.models&&(r=e,n=i.domIndexOf(e,t))})),s.on("drop",(function(t,d,c,l){if(s.models&&d){o=i.domIndexOf(t,d);var p,f=s.models[s.containers.indexOf(c)],h=s.models[s.containers.indexOf(d)];if(d===c)p=(f=f.slice(0)).splice(n,1)[0],f.splice(o,0,p),h=f;else{var v=r!==t;if(p=f[n],v){if(!u.copyItem)throw new Error("If you have enabled `copy` on a group, you must provide a `copyItem` function.");p=u.copyItem(p)}if(v||(f=f.slice(0)).splice(n,1),(h=h.slice(0)).splice(o,0,p),v)try{d.removeChild(t)}catch(e){}}i.dispatch$.next({event:e.EventTypes.DropModel,name:a,args:[t,d,c,l,p,f,h,n,o]})}}))},t.prototype.setupEvents=function(e){var t=this;if(!e.initEvents){e.initEvents=!0;var r=e.name;c.forEach((function(n){e.drake.on(n,(function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];t.dispatch$.next({event:n,name:r,args:e})}))}))}},t.prototype.domIndexOf=function(e,t){return Array.prototype.indexOf.call(t.children,e)},t}();v.decorators=[{type:t.Injectable}],v.ctorParameters=function(){return[{type:p,decorators:[{type:t.Optional}]}]};var g=function(){function e(e,r){this.el=e,this.dragulaService=r,this.dragulaModelChange=new t.EventEmitter}return Object.defineProperty(e.prototype,"container",{get:function(){return this.el&&this.el.nativeElement},enumerable:!1,configurable:!0}),e.prototype.ngOnChanges=function(e){if(e&&e.dragula){var t=e.dragula,r=t.previousValue,n=t.currentValue,o=(t.firstChange,!!n);!!r&&this.teardown(r),o&&this.setup()}else if(e&&e.dragulaModel){var i=e.dragulaModel,a=(r=i.previousValue,n=i.currentValue,i.firstChange,this.group.drake);if(this.dragula&&a){a.models=a.models||[];var s=a.models.indexOf(r);-1!==s?(a.models.splice(s,1),n&&a.models.splice(s,0,n)):n&&a.models.push(n)}}},e.prototype.setup=function(){var e=this,t=this.dragulaService.find(this.dragula);if(!t){t=this.dragulaService.createGroup(this.dragula,{})}!function(t){e.dragulaModel&&(t.drake.models?t.drake.models.push(e.dragulaModel):t.drake.models=[e.dragulaModel])}(t),t.drake.containers.push(this.container),this.subscribe(this.dragula),this.group=t},e.prototype.subscribe=function(e){var t=this;this.subs=new r.Subscription,this.subs.add(this.dragulaService.dropModel(e).subscribe((function(e){var r=e.source,n=e.target,o=e.sourceModel,i=e.targetModel;r===t.el.nativeElement?t.dragulaModelChange.emit(o):n===t.el.nativeElement&&t.dragulaModelChange.emit(i)}))),this.subs.add(this.dragulaService.removeModel(e).subscribe((function(e){var r=e.source,n=e.sourceModel;r===t.el.nativeElement&&t.dragulaModelChange.emit(n)})))},e.prototype.teardown=function(e){this.subs&&this.subs.unsubscribe();var t=this.dragulaService.find(e);if(t){var r=t.drake.containers.indexOf(this.el.nativeElement);if(-1!==r&&t.drake.containers.splice(r,1),this.dragulaModel&&t.drake&&t.drake.models){var n=t.drake.models.indexOf(this.dragulaModel);-1!==n&&t.drake.models.splice(n,1)}}},e.prototype.ngOnDestroy=function(){this.teardown(this.dragula)},e}();g.decorators=[{type:t.Directive,args:[{selector:"[dragula]"}]}],g.ctorParameters=function(){return[{type:t.ElementRef},{type:v}]},g.propDecorators={dragula:[{type:t.Input}],dragulaModel:[{type:t.Input}],dragulaModelChange:[{type:t.Output}]};var y=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[v]}},e}();y.decorators=[{type:t.NgModule,args:[{exports:[g],declarations:[g]}]}];var m=new p((function(e,t){return new b(e,t)})),b=function(){function e(e,t,n){void 0===e&&(e=[]),void 0===t&&(t={}),this.containers=e,this.options=t,this.models=n,this.dragging=!1,this.emitter$=new r.Subject,this.subs=new r.Subscription}return e.prototype.start=function(e){this.dragging=!0},e.prototype.end=function(){this.dragging=!1},e.prototype.cancel=function(e){this.dragging=!1},e.prototype.remove=function(){this.dragging=!1},e.prototype.on=function(e,t){this.subs.add(this.emitter$.pipe(n.filter((function(t){return t.eventType===e}))).subscribe((function(e){var r=e.args;t.apply(void 0,function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e}(r))})))},e.prototype.destroy=function(){this.subs.unsubscribe()},e.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.emitter$.next({eventType:e,args:t})},e}();e.DragulaDirective=g,e.DragulaModule=y,e.DragulaService=v,e.DrakeFactory=p,e.Group=d,e.MockDrake=b,e.MockDrakeFactory=m,e.dragula=l,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ng2-dragula.umd.min.js.map